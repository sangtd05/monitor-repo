global:
  resolve_timeout: 5m

route:
  group_by: ["alertname", "instance"]
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 1h
  receiver: "telegram"

receivers:
  - name: "telegram"
    telegram_configs:
      - bot_token: "${TELEGRAM_BOT_TOKEN}"
        api_url: https://api.telegram.org
        chat_id: ${TELEGRAM_CHAT_ID}
        parse_mode: "HTML"
        message: |
          {{ if eq .Status "firing" }}ğŸ”´ <b>Cáº¢NH BÃO</b>{{ else }}âœ… <b>ÄÃƒ GIáº¢I QUYáº¾T</b>{{ end }}
          
          <b>{{ .GroupLabels.alertname }}</b>
          {{ if .CommonLabels.severity }}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          ğŸ“Š Má»©c Ä‘á»™: <code>{{ .CommonLabels.severity }}</code>{{ end }}
          
          {{- if gt (len .Alerts) 5 }}
          âš ï¸ <i>{{ len .Alerts }} alerts - hiá»ƒn thá»‹ 5 Ä‘áº§u tiÃªn</i>
          {{- end }}
          
          {{- range $index, $alert := .Alerts }}
          {{- if lt $index 5 }}
          
          {{- if $alert.Annotations.summary }}
          ğŸ“ {{ $alert.Annotations.summary }}
          {{- end }}
          {{- if $alert.Labels.instance }}
          ğŸ–¥ <code>{{ $alert.Labels.instance }}</code>
          {{- end }}
          {{- if $alert.Labels.device }}
          ğŸ’¾ Device: <code>{{ $alert.Labels.device }}</code>
          {{- end }}
          {{- if $alert.Labels.mountpoint }}
          ğŸ“ Mount: <code>{{ $alert.Labels.mountpoint }}</code>
          {{- end }}
          ğŸ• {{ ($alert.StartsAt.Add 25200e9).Format "15:04:05 - 02/01/2006" }}
          {{- end }}
          {{- end }}

inhibit_rules:
  - source_match:
      severity: "critical"
    target_match:
      severity: "warning"
    equal: ["alertname", "instance"]
