<mxfile host="app.diagrams.net" agent="Antigravity AI" version="24.0.0">
  <diagram name="Data Flow Architecture" id="dataflow">
    <mxGraphModel dx="1434" dy="844" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="2800" pageHeight="1600" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="LGTM Stack - Detailed Data Flow Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=28;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="600" y="30" width="1600" height="50" as="geometry" />
        </mxCell>
        
        <!-- Layer Labels -->
        <mxCell id="layer1-label" value="DATA SOURCES" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="80" y="120" width="200" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="layer2-label" value="COLLECTORS" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="80" y="580" width="200" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="layer3-label" value="STORAGE" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="80" y="920" width="200" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="layer4-label" value="VISUALIZATION" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="80" y="1240" width="200" height="40" as="geometry" />
        </mxCell>
        
        <!-- ========== METRICS FLOW (Left Column) ========== -->
        <mxCell id="metrics-title" value="METRICS FLOW (Pull Model)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE6E6;strokeColor=#B85450;fontSize=18;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="320" y="120" width="560" height="50" as="geometry" />
        </mxCell>
        
        <!-- Exporters -->
        <mxCell id="node-exporter" value="Node Exporter&lt;br&gt;:9100&lt;br&gt;&lt;br&gt;System Metrics:&lt;br&gt;• CPU, Memory, Disk&lt;br&gt;• Network I/O&lt;br&gt;• Filesystem" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF9E6;strokeColor=#D79B00;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="340" y="200" width="160" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="cadvisor" value="cAdvisor&lt;br&gt;:8080&lt;br&gt;&lt;br&gt;Container Metrics:&lt;br&gt;• CPU/Memory usage&lt;br&gt;• Network I/O&lt;br&gt;• Disk I/O" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF9E6;strokeColor=#D79B00;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="340" y="360" width="160" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="db-exporters" value="DB Exporters&lt;br&gt;:9216 / :9187&lt;br&gt;&lt;br&gt;Database Metrics:&lt;br&gt;• Connections&lt;br&gt;• Query performance&lt;br&gt;• Replication lag" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF9E6;strokeColor=#D79B00;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="540" y="200" width="160" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="nginx-exporter" value="Nginx Exporter&lt;br&gt;:9113&lt;br&gt;&lt;br&gt;Web Server Metrics:&lt;br&gt;• Active connections&lt;br&gt;• Requests/sec&lt;br&gt;• Response codes" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF9E6;strokeColor=#D79B00;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="540" y="360" width="160" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="app-metrics" value="App Metrics&lt;br&gt;:3000/metrics&lt;br&gt;&lt;br&gt;Application Metrics:&lt;br&gt;• HTTP requests&lt;br&gt;• Response time&lt;br&gt;• Error rate" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF9E6;strokeColor=#D79B00;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="740" y="200" width="160" height="140" as="geometry" />
        </mxCell>
        
        <!-- Prometheus -->
        <mxCell id="prometheus" value="Prometheus&lt;br&gt;:9090&lt;br&gt;&lt;br&gt;Scrape Interval: 15s&lt;br&gt;Scrape Timeout: 10s&lt;br&gt;&lt;br&gt;Service Discovery:&lt;br&gt;• File-based (JSON)&lt;br&gt;• Auto-reload" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ff9999;strokeColor=#B85450;fontSize=13;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="420" y="580" width="360" height="160" as="geometry" />
        </mxCell>
        
        <!-- Prometheus Storage -->
        <mxCell id="prom-storage" value="Mimir + MinIO&lt;br&gt;&lt;br&gt;Storage:&lt;br&gt;• Long-term storage (S3)&lt;br&gt;• 1+ Year Retention&lt;br&gt;• Prometheus compatible&lt;br&gt;• Global View" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE6E6;strokeColor=#B85450;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="420" y="920" width="360" height="160" as="geometry" />
        </mxCell>
        
        <!-- Arrows for Metrics -->
        <mxCell id="arrow-m1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF0000;strokeWidth=3;dashed=1;dashPattern=8 8;" edge="1" parent="1" source="node-exporter" target="prometheus">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-m1-label" value="HTTP GET" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#FF0000;" vertex="1" connectable="0" parent="arrow-m1">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow-m2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF0000;strokeWidth=3;dashed=1;dashPattern=8 8;" edge="1" parent="1" source="cadvisor" target="prometheus">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-m3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF0000;strokeWidth=3;dashed=1;dashPattern=8 8;" edge="1" parent="1" source="db-exporters" target="prometheus">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-m4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF0000;strokeWidth=3;dashed=1;dashPattern=8 8;" edge="1" parent="1" source="nginx-exporter" target="prometheus">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-m5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF0000;strokeWidth=3;dashed=1;dashPattern=8 8;" edge="1" parent="1" source="app-metrics" target="prometheus">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-m6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF0000;strokeWidth=2;" edge="1" parent="1" source="prometheus" target="prom-storage">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-m6-label" value="WRITE" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#FF0000;" vertex="1" connectable="0" parent="arrow-m6">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- ========== LOGS FLOW (Middle Column) ========== -->
        <mxCell id="logs-title" value="LOGS FLOW (Push Model)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF9E6;strokeColor=#D79B00;fontSize=18;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="960" y="120" width="560" height="50" as="geometry" />
        </mxCell>
        
        <!-- Log Sources -->
        <mxCell id="docker-logs" value="Docker Containers&lt;br&gt;&lt;br&gt;Log Files:&lt;br&gt;• /var/lib/docker/&lt;br&gt;  containers/&lt;br&gt;• JSON format&lt;br&gt;• Auto-rotation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1F5FF;strokeColor=#6C8EBF;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="980" y="200" width="160" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="system-logs" value="System Logs&lt;br&gt;&lt;br&gt;Log Files:&lt;br&gt;• /var/log/syslog&lt;br&gt;• /var/log/auth.log&lt;br&gt;• /var/log/kern.log" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1F5FF;strokeColor=#6C8EBF;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="980" y="360" width="160" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="app-logs" value="NestJS Application&lt;br&gt;&lt;br&gt;Pino Logger:&lt;br&gt;• Structured JSON&lt;br&gt;• Log levels&lt;br&gt;• Trace correlation&lt;br&gt;• Direct push" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1F5FF;strokeColor=#6C8EBF;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1180" y="200" width="160" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="db-logs" value="Database Logs&lt;br&gt;&lt;br&gt;Log Files:&lt;br&gt;• PostgreSQL logs&lt;br&gt;• MongoDB logs&lt;br&gt;• Slow queries&lt;br&gt;• Audit logs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1F5FF;strokeColor=#6C8EBF;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1180" y="360" width="160" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="nginx-logs" value="Nginx Logs&lt;br&gt;&lt;br&gt;Log Files:&lt;br&gt;• access.log&lt;br&gt;• error.log&lt;br&gt;• Custom format" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1F5FF;strokeColor=#6C8EBF;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1380" y="200" width="160" height="140" as="geometry" />
        </mxCell>
        
        <!-- Promtail -->
        <mxCell id="promtail" value="Grafana Alloy&lt;br&gt;:12345&lt;br&gt;&lt;br&gt;Pipeline Stages:&lt;br&gt;1. Discovery (Docker)&lt;br&gt;2. Parsing (JSON/Regex)&lt;br&gt;3. Filtering &amp; Labeling&lt;br&gt;4. Forward to Loki&lt;br&gt;5. Forward to Tempo" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF4E6;strokeColor=#D79B00;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="980" y="580" width="240" height="160" as="geometry" />
        </mxCell>
        
        <!-- Loki -->
        <mxCell id="loki" value="Loki&lt;br&gt;:3100&lt;br&gt;&lt;br&gt;Endpoint:&lt;br&gt;• /loki/api/v1/push&lt;br&gt;&lt;br&gt;Label Strategy:&lt;br&gt;• job, host, level&lt;br&gt;• service, container" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcc99;strokeColor=#D79B00;fontSize=13;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1260" y="580" width="240" height="160" as="geometry" />
        </mxCell>
        
        <!-- Loki Storage -->
        <mxCell id="loki-storage" value="Loki Storage (MinIO)&lt;br&gt;&lt;br&gt;Storage:&lt;br&gt;• Index (BoltDB-Shipper)&lt;br&gt;• Chunks in S3 Buckets&lt;br&gt;• Retention: 30 days&lt;br&gt;• High Compression" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF9E6;strokeColor=#D79B00;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="1060" y="920" width="360" height="160" as="geometry" />
        </mxCell>
        
        <!-- Arrows for Logs -->
        <mxCell id="arrow-l1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#0000FF;strokeWidth=3;" edge="1" parent="1" source="docker-logs" target="promtail">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-l1-label" value="READ" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#0000FF;" vertex="1" connectable="0" parent="arrow-l1">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow-l2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#0000FF;strokeWidth=3;" edge="1" parent="1" source="system-logs" target="promtail">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-l3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#0000FF;strokeWidth=3;" edge="1" parent="1" source="db-logs" target="promtail">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-l4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#0000FF;strokeWidth=3;" edge="1" parent="1" source="nginx-logs" target="promtail">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1460" y="540" />
              <mxPoint x="1100" y="540" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow-l5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#0000FF;strokeWidth=3;" edge="1" parent="1" source="app-logs" target="loki">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-l5-label" value="HTTP POST" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#0000FF;" vertex="1" connectable="0" parent="arrow-l5">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow-l6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#0000FF;strokeWidth=3;" edge="1" parent="1" source="promtail" target="loki">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-l6-label" value="HTTP POST" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#0000FF;" vertex="1" connectable="0" parent="arrow-l6">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow-l7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#0000FF;strokeWidth=2;" edge="1" parent="1" source="loki" target="loki-storage">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-l7-label" value="WRITE" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#0000FF;" vertex="1" connectable="0" parent="arrow-l7">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- ========== TRACES FLOW (Right Column) ========== -->
        <mxCell id="traces-title" value="TRACES FLOW (Push Model)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1BEE7;strokeColor=#8E24AA;fontSize=18;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1600" y="120" width="560" height="50" as="geometry" />
        </mxCell>
        
        <!-- Trace Sources -->
        <mxCell id="nestjs-app" value="NestJS Application&lt;br&gt;&lt;br&gt;OpenTelemetry SDK:&lt;br&gt;• Auto-instrumentation&lt;br&gt;• HTTP requests&lt;br&gt;• Database queries&lt;br&gt;• External API calls&lt;br&gt;• Custom spans" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1F5FF;strokeColor=#6C8EBF;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1700" y="200" width="180" height="180" as="geometry" />
        </mxCell>
        
        <mxCell id="trace-context" value="Trace Context&lt;br&gt;&lt;br&gt;• Trace ID&lt;br&gt;• Span ID&lt;br&gt;• Parent Span ID&lt;br&gt;• Trace flags&lt;br&gt;• Baggage" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#8E24AA;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="1920" y="200" width="140" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="span-attributes" value="Span Attributes&lt;br&gt;&lt;br&gt;• http.method&lt;br&gt;• http.status_code&lt;br&gt;• db.statement&lt;br&gt;• service.name&lt;br&gt;• error details" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#8E24AA;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="2100" y="200" width="140" height="140" as="geometry" />
        </mxCell>
        
        <!-- OTel Collector -->
        <mxCell id="otel-collector" value="Grafana Alloy&lt;br&gt;:4317 (gRPC) / :4318 (HTTP)&lt;br&gt;&lt;br&gt;Pipelines:&lt;br&gt;• Traces OTLP In -&gt; Tempo&lt;br&gt;• Metrics OTLP In -&gt; Prometheus&lt;br&gt;• Logs OTLP In -&gt; Loki&lt;br&gt;&lt;br&gt;Processors:&lt;br&gt;• Batch &amp; Memory Limiter" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#cc99ff;strokeColor=#8E24AA;fontSize=12;fontStyle=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="1700" y="540" width="360" height="200" as="geometry" />
        </mxCell>
        
        <!-- Tempo -->
        <mxCell id="tempo" value="Tempo + MinIO (S3)&lt;br&gt;:3200&lt;br&gt;&lt;br&gt;Features:&lt;br&gt;• Trace storage in S3&lt;br&gt;• Metrics generator&lt;br&gt;• Service graph&lt;br&gt;• Span metrics" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1BEE7;strokeColor=#8E24AA;fontSize=13;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1700" y="920" width="360" height="160" as="geometry" />
        </mxCell>
        
        <!-- Arrows for Traces -->
        <mxCell id="arrow-t1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#9C27B0;strokeWidth=3;" edge="1" parent="1" source="nestjs-app" target="otel-collector">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-t1-label" value="OTLP" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#9C27B0;" vertex="1" connectable="0" parent="arrow-t1">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow-t2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#9C27B0;strokeWidth=2;" edge="1" parent="1" source="otel-collector" target="tempo">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-t2-label" value="EXPORT" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#9C27B0;" vertex="1" connectable="0" parent="arrow-t2">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow-t3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#9C27B0;strokeWidth=2;dashed=1;" edge="1" parent="1" source="otel-collector" target="prom-storage">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1880" y="800" />
              <mxPoint x="600" y="800" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-t3-label" value="Span Metrics" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#9C27B0;" vertex="1" connectable="0" parent="arrow-t3">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- ========== VISUALIZATION LAYER ========== -->
        <mxCell id="grafana-box" value="Grafana :3000" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#99ff99;strokeColor=#82B366;fontSize=20;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="420" y="1240" width="1640" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="grafana-features" value="Unified Visualization Platform&lt;br&gt;• Query all data sources (Prometheus, Loki, Tempo)&lt;br&gt;• Correlation: Jump between metrics → traces → logs&lt;br&gt;• Dashboards, Alerts, Explore" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="520" y="1260" width="1440" height="40" as="geometry" />
        </mxCell>
        
        <!-- Query Arrows -->
        <mxCell id="arrow-q1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#009688;strokeWidth=3;" edge="1" parent="1" source="prom-storage" target="grafana-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-q1-label" value="PromQL" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#009688;" vertex="1" connectable="0" parent="arrow-q1">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow-q2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#009688;strokeWidth=3;" edge="1" parent="1" source="loki-storage" target="grafana-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-q2-label" value="LogQL" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#009688;" vertex="1" connectable="0" parent="arrow-q2">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow-q3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#009688;strokeWidth=3;" edge="1" parent="1" source="tempo" target="grafana-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-q3-label" value="TraceQL" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#009688;" vertex="1" connectable="0" parent="arrow-q3">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- ========== ALERTING FLOW ========== -->
        <mxCell id="alerting-box" value="ALERTING FLOW" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE6E6;strokeColor=#B85450;fontSize=16;fontStyle=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="2200" y="580" width="480" height="500" as="geometry" />
        </mxCell>
        
        <mxCell id="alert-rules" value="Alert Rules&lt;br&gt;&lt;br&gt;Prometheus:&lt;br&gt;• High CPU &gt; 80%&lt;br&gt;• High Memory &gt; 85%&lt;br&gt;• Disk Full &gt; 90%&lt;br&gt;• Service Down&lt;br&gt;• High Error Rate &gt; 5%" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF9E6;strokeColor=#D79B00;fontSize=11;align=left;" vertex="1" parent="1">
          <mxGeometry x="2240" y="640" width="200" height="160" as="geometry" />
        </mxCell>
        
        <mxCell id="alertmanager-flow" value="Alertmanager&lt;br&gt;:9093&lt;br&gt;&lt;br&gt;Processing:&lt;br&gt;• Grouping&lt;br&gt;• Inhibition&lt;br&gt;• Silencing&lt;br&gt;• Routing" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE6E6;strokeColor=#B85450;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="2240" y="840" width="200" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="telegram-bot" value="Telegram Bot&lt;br&gt;&lt;br&gt;Notifications:&lt;br&gt;• Alert FIRING&lt;br&gt;• Alert RESOLVED&lt;br&gt;• Severity levels&lt;br&gt;• Alert details" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF9C4;strokeColor=#FBC02D;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="2480" y="840" width="160" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-a1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF6B6B;strokeWidth=2;" edge="1" parent="1" source="prometheus" target="alert-rules">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="800" y="660" />
              <mxPoint x="2340" y="660" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-a1-label" value="Evaluate" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#FF6B6B;" vertex="1" connectable="0" parent="arrow-a1">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow-a2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF6B6B;strokeWidth=2;" edge="1" parent="1" source="alert-rules" target="alertmanager-flow">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-a2-label" value="Fire Alert" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#FF6B6B;" vertex="1" connectable="0" parent="arrow-a2">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow-a3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF6B6B;strokeWidth=2;" edge="1" parent="1" source="alertmanager-flow" target="telegram-bot">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-a3-label" value="Send" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#FF6B6B;" vertex="1" connectable="0" parent="arrow-a3">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- Data Format Examples -->
        <mxCell id="formats-box" value="DATA FORMATS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F5F5F5;strokeColor=#666666;fontSize=14;fontStyle=1;verticalAlign=top;align=left;" vertex="1" parent="1">
          <mxGeometry x="2200" y="1120" width="480" height="200" as="geometry" />
        </mxCell>
        
        <mxCell id="formats-text" value="Metrics (Prometheus format):&lt;br&gt;node_cpu_seconds_total{cpu=&quot;0&quot;,mode=&quot;idle&quot;} 123456.78&lt;br&gt;&lt;br&gt;Logs (JSON):&lt;br&gt;{&quot;level&quot;:&quot;error&quot;,&quot;msg&quot;:&quot;Failed&quot;,&quot;trace_id&quot;:&quot;abc123&quot;}&lt;br&gt;&lt;br&gt;Traces (OTLP):&lt;br&gt;Span{trace_id, span_id, parent_id, name, duration}" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontFamily=Courier New;" vertex="1" parent="1">
          <mxGeometry x="2240" y="1160" width="400" height="140" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
