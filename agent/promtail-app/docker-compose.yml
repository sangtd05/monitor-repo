services:
  promtail-app:
    image: grafana/promtail:latest
    container_name: promtail-app
    restart: unless-stopped
    command:
      - -config.file=/etc/promtail/promtail.yml
      - -config.expand-env=true
    volumes:
      - ./promtail.yml:/etc/promtail/promtail.yml:ro
      - /var/log:/var/log:ro
      - promtail-positions:/tmp
    environment:
      - LOKI_URL=http://<MONITOR_HOST_OR_IP>:3100/loki/api/v1/push
      - LOKI_TENANT_ID=1
      - APP_NAME=my-app
      - INSTANCE=${HOSTNAME}
      - LOG_PATH=/var/log/my-app/*.log

volumes:
  promtail-positions:
