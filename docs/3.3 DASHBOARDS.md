# ğŸ“Š Grafana Dashboards Guide

TÃ i liá»‡u nÃ y mÃ´ táº£ chi tiáº¿t cÃ¡c Dashboards cÃ³ sáºµn trong há»‡ thá»‘ng Monitoring (LGTM Stack).

## ğŸ—‚ï¸ Danh sÃ¡ch Dashboards

Há»‡ thá»‘ng hiá»‡n cÃ³ **12 Dashboards** Ä‘Æ°á»£c chia thÃ nh cÃ¡c nhÃ³m:

### 1. Infrastructure Monitoring
GiÃ¡m sÃ¡t sá»©c khá»e cá»§a Servers vÃ  Containers.

| Dashboard | File | MÃ´ táº£ |
|-----------|------|-------|
| **Node Exporter Full** | `node-exporter-full.json` | Monitor chi tiáº¿t Linux Servers (CPU, RAM, Disk, Network). Dashboard chÃ­nh Ä‘á»ƒ kiá»ƒm tra health cá»§a tá»«ng node. |
| **Docker Monitoring** | `cadvisor-docker.json` | Monitor Docker Containers (CPU/RAM usage per container, Network I/O). |
| **Blackbox Health** | `blackbox-health.json` | Uptime monitoring (HTTP/TCP probes). Kiá»ƒm tra connectivity Ä‘áº¿n cÃ¡c endpoints. |

### 2. Database Monitoring
GiÃ¡m sÃ¡t hiá»‡u nÄƒng vÃ  logs cá»§a Databases.

| Dashboard | File | MÃ´ táº£ |
|-----------|------|-------|
| **MongoDB Overview** | `mongodb.json` | Monitor MongoDB Cluster (Connections, Ops/sec, Replication Lag, Memory). |
| **MongoDB Logs** | `mongodb-logs.json` | Dashboard chuyÃªn biá»‡t xem logs cá»§a MongoDB tá»« Loki (Slow queries, Errors). |
| **PostgreSQL Overview** | `postgresql.json` | Monitor PostgreSQL (Active connections, Transactions, Cache hit ratio, Deadlocks). |
| **PostgreSQL Logs** | `postgresql-logs.json` | Dashboard chuyÃªn biá»‡t xem logs cá»§a PostgreSQL tá»« Loki. |

### 3. Web Server & Load Balancer

| Dashboard | File | MÃ´ táº£ |
|-----------|------|-------|
| **Nginx Exporter** | `nginx-exporter.json` | Monitor Nginx (Request rate, Active connections, Reading/Writing/Waiting status). |

### 4. Application & Tracing (APM)
GiÃ¡m sÃ¡t hiá»‡u nÄƒng á»©ng dá»¥ng thÃ´ng qua Metrics vÃ  Traces.

| Dashboard | File | MÃ´ táº£ |
|-----------|------|-------|
| **Service Graph** | `service-graph.json` | Biá»ƒu Ä‘á»“ phá»¥ thuá»™c giá»¯a cÃ¡c services (Ä‘Æ°á»£c táº¡o tá»« Tempo/Traces). GiÃºp hÃ¬nh dung kiáº¿n trÃºc microservices. |
| **RED Metrics** | `metrics-red.json` | Rate (Req/s), Errors (%), Duration (Latency) cho tá»«ng service. Data derived tá»« Spans (Tempo). |
| **Performance** | `performance.json` | Tá»•ng há»£p performance metrics quan trá»ng. |

### 5. Alerting System

| Dashboard | File | MÃ´ táº£ |
|-----------|------|-------|
| **Alertmanager** | `alertmanager.json` | Tráº¡ng thÃ¡i cá»§a Alertmanager, thá»‘ng kÃª cÃ¡c alerts Ä‘ang active/silenced. |

---

## ğŸš€ HÆ°á»›ng dáº«n Sá»­ dá»¥ng

### 1. Infrastructure Checks
Khi há»‡ thá»‘ng cháº­m, hÃ£y kiá»ƒm tra theo thá»© tá»±:
1. Má»Ÿ **Node Exporter Full**:
   - Check **CPU Load**: Náº¿u cao > 80% â†’ CPU bottleneck.
   - Check **Memory Available**: Náº¿u tháº¥p â†’ Disk swap/OOM.
   - Check **Disk I/O**: Náº¿u I/O wait cao â†’ Disk bottleneck.
2. Má»Ÿ **Docker Monitoring**:
   - TÃ¬m container nÃ o Ä‘ang chiáº¿m nhiá»u resource nháº¥t.

### 2. Database Troubleshooting
Khi API liÃªn quan Ä‘áº¿n DB cháº­m:
1. Má»Ÿ **PostgreSQL/MongoDB Overview**:
   - Check **Connections**: CÃ³ bá»‹ full connection pool khÃ´ng?
   - Check **Ops/sec**: CÃ³ spike Ä‘á»™t ngá»™t khÃ´ng?
2. Má»Ÿ **PostgreSQL/MongoDB Logs**:
   - Filter `level=error`.
   - TÃ¬m cÃ¡c log "Slow query" (thÆ°á»ng > 100ms hoáº·c 1s).

### 3. Application Debugging (APM)
Khi user bÃ¡o lá»—i 500 hoáº·c latency cao:
1. Má»Ÿ **RED Metrics**:
   - XÃ¡c Ä‘á»‹nh Service nÃ o cÃ³ Error rate cao hoáº·c Latency tÄƒng.
2. Má»Ÿ **Service Graph**:
   - Xem service Ä‘Ã³ phá»¥ thuá»™c vÃ o service nÃ o khÃ¡c bá»‹ lá»—i khÃ´ng.
3. Drill down vÃ o **Traces** (Tempo):
   - Tá»« metrics, nháº£y sang trace cá»¥ thá»ƒ Ä‘á»ƒ xem waterfall view.
   - XÃ¡c Ä‘á»‹nh span nÃ o chiáº¿m nhiá»u thá»i gian nháº¥t (DB query? External API?).

### 4. Alerting
Khi nháº­n Ä‘Æ°á»£c alert Telegram:
1. Má»Ÿ **Alertmanager** dashboard Ä‘á»ƒ xem chi tiáº¿t alert group.
2. Dá»±a vÃ o labels (vÃ­ dá»¥ `instance=db-01`), má»Ÿ dashboard tÆ°Æ¡ng á»©ng (Database Monitoring) Ä‘á»ƒ Ä‘iá»u tra.

---

## ğŸ”§ Maintenance

- Dashboards Ä‘Æ°á»£c lÆ°u dÆ°á»›i dáº¡ng **JSON** táº¡i `grafana/provisioning/dashboards/`.
- Grafana sáº½ tá»± Ä‘á»™ng load cÃ¡c file nÃ y khi khá»Ÿi Ä‘á»™ng (Provisioning).
- **KhÃ´ng nÃªn edit dashboard trá»±c tiáº¿p trÃªn UI** rá»“i save, vÃ¬ sáº½ máº¥t khi restart container. HÃ£y export JSON vÃ  replace file trong source code.
